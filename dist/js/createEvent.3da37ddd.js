"use strict";(self["webpackChunkmawed"]=self["webpackChunkmawed"]||[]).push([[764],{9363:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview_invite",class:{is_open:t.isOpen}},[e("div",{staticClass:"preview_header border-bottom"},[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"fs-lg"},[t._v(t._s(t.$t("preview")))]),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-2 mt-1",attrs:{title:t.$t("previewDesc")}},[e("BIcon",{staticClass:"mr-3",staticStyle:{opacity:"0.3"},attrs:{icon:"question-circle",scale:"1.2"}})],1)]),e("b-btn",{staticClass:"font-weight-500 border d-flex align-items-center px-4 py-2",attrs:{variant:"outline-dark"},on:{click:t.close}},[e("BIcon",{staticClass:"mr-2",staticStyle:{"margin-bottom":"1px"},attrs:{icon:"box-arrow-left",scale:"1"}}),t._v(" "+t._s(t.$t("exitPreview"))+" ")],1)],1),e("div",{staticClass:"preview_body"},[e("b-container",{style:`max-width: ${t.availableDate?"1130px":"880px"} !important`},[e("b-card",{staticStyle:{"border-radius":"10px"},attrs:{"body-class":"pt-5 pb-2 px-3 px-lg-5"}},[e("b-row",[e("b-col",{attrs:{cols:"12",lg:"4"}},[e("div",{attrs:{md:"text"}},[e("b-avatar",{attrs:{src:"https://placekitten.com/300/300",size:"10rem"}}),e("h4",{staticClass:"mt-2 text-muted"},[t._v(t._s(t.$me.username))]),e("h3",{staticClass:"mt-2 mb-3"},[t._v(t._s(t.invite.name))]),e("div",[e("BIcon",{staticClass:"mr-2",attrs:{icon:"clock-history",scale:"1.2"}}),e("span",{staticClass:"text-muted"},[t._v(t._s(t.durationStr))])],1),t.selectedDate?e("div",{staticClass:"my-3 font-weight-500 text-success"},[e("BIcon",{staticClass:"mr-2",attrs:{icon:"calendar4-event",scale:"1.2"}}),e("span",[t._v(t._s(t.selectedDateFormat))])],1):t._e()],1)]),e("b-col",{attrs:{cols:"12",lg:"8"}},[e("div",{staticClass:"d-flex flex-column",staticStyle:{"min-height":"561px"}},[t.selectedDate?[e("span",{staticClass:"mb-5",staticStyle:{"font-size":"1.5rem"}},[t._v(t._s(t.$t("yourContactInfo")))]),e("FormInput",{directives:[{name:"vuelidate",rawName:"v-vuelidate",value:t.contact.fullName,expression:"contact.fullName"}],staticClass:"mb-5",attrs:{label:t.$t("fullName"),placeholder:t.$t("fullNamePlaceholder"),required:""},model:{value:t.contact.fullName,callback:function(e){t.$set(t.contact,"fullName",e)},expression:"contact.fullName"}}),e("FormInput",{directives:[{name:"vuelidate",rawName:"v-vuelidate",value:t.contact.email,expression:"contact.email"}],staticClass:"mb-5",attrs:{label:t.$t("email"),placeholder:t.$t("emailPlaceholder"),required:"",type:"email"},model:{value:t.contact.email,callback:function(e){t.$set(t.contact,"email",e)},expression:"contact.email"}}),t.contact.hasGuests?e("div",[e("label",{staticClass:"fs-sm text-muted",attrs:{for:"guestsEmail"}},[t._v(t._s(t.$t("guestsEmail")))]),e("BFormTags",{attrs:{"tag-validator":t.isValidEmail,id:"guestsEmail",placeholder:t.$t("addGuestsPlaceholder"),"invalid-tag-text":t.$t("invalidEmails"),"add-button-text":t.$t("add"),"tag-variant":"primary"},model:{value:t.contact.guests,callback:function(e){t.$set(t.contact,"guests",e)},expression:"contact.guests"}})],1):e("span",[e("b-button",{staticClass:"filter_btn active font-weight-500",attrs:{size:"sm"},on:{click:function(e){t.contact.hasGuests=!0}}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:"plus-lg",scale:"0.8"}}),t._v(" "+t._s(t.$t("addGuests"))+" ")],1)],1),e("div",{staticClass:"d-flex align-items-center justify-content-end mt-auto py-3"},[e("b-button",{staticClass:"filter_btn active mr-3 font-weight-500",attrs:{size:"sm"},on:{click:function(e){t.selectedDate=null}}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:""+(t.$isRtl?"chevron-right":"chevron-left"),scale:"0.8"}}),t._v(" "+t._s(t.$t("back"))+" ")],1),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.$t("scheduleMeetingDisabledTooltip")}},[e("b-button",{staticClass:"filter_btn disabled font-weight-500",attrs:{size:"sm",disabled:""}},[t._v(" "+t._s(t.$t("scheduleMeeting"))+" ")])],1)],1)]:[e("span",{staticStyle:{"font-size":"1.5rem"}},[t._v(t._s(t.$t("selectDateAndTime")))]),e("div",{staticClass:"custom_calendar mt-5"},[e("div",{staticClass:"d-flex"},[e("div",{style:""+(t.times.length?"min-width: 70%":"width:100%")},[e("date-picker",{staticClass:"border-0",attrs:{timezone:"UTC","max-date":t.maxDate,"min-date":t.minDate,"disabled-dates":{start:null,end:null},"available-dates":t.availableDates.map((t=>t.date)),"is-expanded":"","title-position":"left",locale:{id:t.$i18n.locale,firstDayOfWeek:2}},on:{"update:from-page":t.updateFromPage},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),e("div",{staticClass:"mt-5"},[e("time-zones",{ref:"timezone",staticClass:"custom_timezone",model:{value:t.timezone,callback:function(e){t.timezone=e},expression:"timezone"}})],1)],1),t.times.length?e("div",{staticClass:"times w-100"},[e("div",{staticClass:"mt-2 pt-1 mb-3 text-nowrap font-weight-500 pl-3"},[t._v(" "+t._s(t.$moment(t.date).format("dddd, MMM D"))+" ")]),e("div",{staticClass:"times_body custom_scroll px-3"},t._l(t.times,(function(a,s){return e("div",{key:s,staticClass:"btn_outline",attrs:{role:"button"},on:{click:function(e){return t.handleSelect(a.value)}}},[t._v(" "+t._s(a.text)+" ")])})),0)]):t._e()])])]],2)])],1)],1)],1)],1)])},i=[],n=a(2416),l=a.n(n),o=a(8557),r=a(9868),m=a(4165),c=a(3673),d=a(6289),u=a(4659),h=a(5795),v={components:{DatePicker:l(),TimeZones:o.Z,FormInput:r.Z},mixins:[u.oE],data(){return{isOpen:!1,date:"",month:(0,m.Z)().month(),year:(0,m.Z)().year(),timezone:m.Z.tz.guess(),selectedDate:"",contact:{fullName:"",email:"",guests:[],hasGuests:!1}}},mounted(){this.getCalendarsEvents(),this.$store.dispatch("getInvites"),this.$store.dispatch("getInvite","472f9680")},validations:{contact:{fullName:{required:h.C1,minLength:(0,h.Ei)(4),maxLength:(0,h.BS)(50)},email:{required:h.C1,email:h.Do}}},computed:{invite(){return this.$store.state.invites.one},calendarsEvents(){return this.$store.state.calendarsEvents},offset(){return(0,c.o)(this.invite.timezone)-(0,c.o)(this.timezone)},minDate(){return this.invite.dateRange.start.clone().add(this.offset,"m").toDate()},maxDate(){let t=this.invite.dateRange.end;if(t)return t.clone().add(this.offset,"m").toDate()},durationStr(){let t=this.invite.duration;if(t<60)return this.$moment.duration(t,"minutes").humanize();let e=Math.floor(t/60);if(t%=60,0===t)return this.$moment.duration(e,"hours").humanize();e=this.$moment.duration(e,"hours").humanize(),t=this.$moment.duration(t,"minutes").humanize();let a=this.$isRtl?" Ùˆ ":" ";return e+a+t},availableDates(){let t=[],e=this.$moment().utc().startOf("date").month(this.month).year(this.year).startOf("month"),a=e.clone().endOf("month");for(let s of this.invite.availability){let i=(0,d.SA)(s.rrule),n=i.between(e.toDate(),a.toDate());for(let e of n){e=this.$moment(e).utc().add(this.offset,"m");let a=e.clone().startOf("date"),i=e.clone(),n=s.duration,l=t.find((t=>t.date.isSame(a,"date")));l||(l={date:a,intervals:[]},t.push(l));while(n>0){let e=60*i.hour()+i.minute(),s=this.invite.minimumNotice+-1*(0,c.o)(this.timezone);i.clone().isAfter(this.$moment().utc().add(s,"m"))&&(this.isReservedDate(i)||(i.isSame(a,"date")?l.intervals.push({minutes:e}):(a=i.clone(),l=t.find((t=>t.date.isSame(a,"date"))),l?l.intervals.push({minutes:e}):(l={date:a.clone().startOf("date"),intervals:[{minutes:e}]},t.push(l))))),n-=this.invite.slotIncrement,i.add(this.invite.slotIncrement,"m")}}}return t=t.filter((t=>t.intervals.length>0)),t=t.map((t=>(t.intervals.sort(((t,e)=>t.minutes-e.minutes)),t.date=t.date.toDate(),t))),t},availableDate(){return this.availableDates.find((t=>this.$moment(this.date).utc().startOf("date").isSame(this.$moment(t.date).utc().startOf("date"),"date")))},times(){if(!this.availableDate)return[];let{date:t,intervals:e}=this.availableDate;return 0==e.length?[]:(t=this.$moment(t).utc().startOf("date"),e=e.map((e=>{let a=t.clone().minute(e.minutes);return{text:a.clone().format("h:mm a"),value:a.clone().add(-1*this.offset,"m").toDate().toISOString()}})),e)},selectedDateFormat(){let t=this.$moment(this.selectedDate).utc().add(this.offset,"m");return t=t.format("ddd, MMM D, h:mm a"),t+" "+this.$moment.tz(this.timezone).format("z")}},watch:{isOpen(t){let e=document.querySelector("body");t?(e.classList.add("preview_invite_open"),e.style.overflow="hidden"):(e.classList.remove("preview_invite_open"),e.style.overflow="auto",this.close())},date(){this.selectedDate=""},timezone(){this.date=""},month(t){this.getCalendarsEvents(t)}},methods:{open(){this.isOpen=!0},close(){this.isOpen=!1,this.date="",this.timezone=this.$moment.tz.guess(),this.contact.hasGuests=!1},getCalendarsEvents(t){t="undefined"==typeof t?this.month:t;let e=this.$moment().month(t).utc().startOf("month").toDate().toISOString(),a=this.$moment().month(t).utc().endOf("month").toDate().toISOString(),s=`?startDate=${e}&endDate=${a}&timezone=UTC`;return this.$store.dispatch("getCalendarsEvents",{query:s})},isReservedDate(t){if(!this.invite.preventConflict)return!1;let e=-1*(0,c.o)(this.timezone);for(let a of this.calendarsEvents){let s=this.$moment(a.start).utc().add(e,"m"),i=this.$moment(a.end).utc().add(e,"m");if(t.isSame(s,"minute"))return!0;if(t.isBetween(s,i))return!0;if(t.isBetween(s.clone().add(-1*this.invite.bufferBeforeEvent,"m"),s.clone().add(this.invite.bufferAfterEvent,"m")))return!0}return!1},updateFromPage(t){this.month=t.month-1,this.year=t.year},handleSelect(t){this.selectedDate=t},isValidEmail(t){let e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(String(t).toLowerCase())}}},f=v,p=a(1001),b=(0,p.Z)(f,s,i,!1,null,null,null),g=b.exports}}]);