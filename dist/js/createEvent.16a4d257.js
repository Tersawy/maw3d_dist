"use strict";(self["webpackChunkmawed"]=self["webpackChunkmawed"]||[]).push([[764],{776:function(t,e,s){s.r(e),s.d(e,{default:function(){return $}});s(6699);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create_event"},[t.$isLoggedIn?e("div",{staticClass:"p-2 text-muted d-flex align-items-center justify-content-center",staticStyle:{"background-color":"#e8f0fe"}},[e("span",{staticClass:"fs-sm"},[t._v(t._s(t.$t("viewAsOrganizer")))]),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"cursor-pointer",attrs:{title:t.$t("editInvite")},on:{click:function(e){return t.$router.push({name:"editLinkIndexForm",params:{inviteId:t.invite.inviteID}})}}},[e("BIcon",{staticClass:"mx-3",attrs:{icon:"pencil",scale:"1.2"}})],1),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"cursor-pointer",attrs:{title:t.$t("home")},on:{click:function(e){return t.$router.push({name:"home"})}}},[e("BIcon",{attrs:{icon:"house-door",scale:"1.2"}})],1)]):t._e(),e("div",{staticClass:"py-0 py-lg-5"},[e("b-container",{staticClass:"px-0 px-lg-4"},[e("b-card",{staticStyle:{"border-radius":"10px"},attrs:{"body-class":"pt-5 pb-2 px-3 pl-lg-5","img-src":t.inviteImage,"img-top":"","img-height":"200px"}},[e("b-row",[e("b-col",{attrs:{cols:"12",lg:"4"}},[e("div",{staticClass:"position-relative",style:""+(t.inviteImage?"top: -7rem":"")},[e("b-avatar",{staticClass:"p-1 bg-white",attrs:{src:t.userPicture,size:"9rem"}}),e("h4",{staticClass:"mt-2 text-muted",staticStyle:{"font-size":"19px"}},[t._v(t._s(t.user.firstName)+" "+t._s(t.user.lastName))]),e("h3",{staticClass:"mt-2 mb-3"},[t._v(t._s(t.invite.name))]),e("div",[e("BIcon",{staticClass:"mr-2",attrs:{icon:"clock-history",scale:"1.2"}}),e("span",{staticClass:"text-muted"},[t._v(t._s(t.durationStr))])],1),t.selectedDate?e("div",{staticClass:"my-3 font-weight-500 text-success"},[e("BIcon",{staticClass:"mr-2",attrs:{icon:"calendar4-event",scale:"1.2"}}),e("span",[t._v(t._s(t.selectedDateFormat))])],1):t._e()],1)]),e("b-col",{attrs:{cols:"12",lg:"8"}},[e("div",{staticClass:"d-flex flex-column pl-lg-4",staticStyle:{"min-height":"561px"}},[t.selectedDate?[e("span",{staticClass:"mb-5",staticStyle:{"font-size":"1.5rem"}},[t._v(t._s(t.$t("yourContactInfo")))]),e("FormInput",{directives:[{name:"vuelidate",rawName:"v-vuelidate",value:t.contact.fullName,expression:"contact.fullName"}],staticClass:"mb-5",attrs:{label:t.$t("fullName"),placeholder:t.$t("fullNamePlaceholder"),required:""},model:{value:t.contact.fullName,callback:function(e){t.$set(t.contact,"fullName",e)},expression:"contact.fullName"}}),e("FormInput",{directives:[{name:"vuelidate",rawName:"v-vuelidate",value:t.contact.email,expression:"contact.email"}],staticClass:"mb-5",attrs:{label:t.$t("email"),placeholder:t.$t("emailPlaceholder"),required:"",type:"email"},model:{value:t.contact.email,callback:function(e){t.$set(t.contact,"email",e)},expression:"contact.email"}}),t.invite.customQuestions&&t.invite.customQuestions.length?t._l(t.invite.customQuestions,(function(s,i){return e("div",{key:i},[["short_text","long_text"].includes(s.type)?e("FormInput",{staticClass:"mb-5",attrs:{label:s.question,placeholder:s.placeholder,required:s.required},model:{value:t.customQuestions[i].value,callback:function(e){t.$set(t.customQuestions[i],"value",e)},expression:"customQuestions[i].value"}}):"multiple_choice"==s.type?[e("label",{staticClass:"text-muted fs-sm"},[t._v(t._s(s.question)+" "+t._s(s.required?"*":""))]),e("b-form-group",{staticClass:"mb-4 pb-2 text-muted"},[e("BFormRadioGroup",{attrs:{options:s.options},model:{value:t.customQuestions[i].value,callback:function(e){t.$set(t.customQuestions[i],"value",e)},expression:"customQuestions[i].value"}})],1)]:"attachment"==s.type?[e("label",{staticClass:"text-muted fs-sm d-block"},[t._v(t._s(s.question)+" "+t._s(s.required?"*":""))]),e("label",{staticClass:"mb-5 border py-2 px-3 btn btn-light btn-sm",attrs:{for:"file"}},[e("span",[e("BIcon",{attrs:{icon:"link",rotate:"90"}})],1),e("span",[t._v(t._s(t.customQuestions[i].value?t.customQuestions[i].value.name:t.$t("attachFile")))])]),e("b-form-file",{staticClass:"d-none",attrs:{type:"file",id:"file",hidden:""},model:{value:t.customQuestions[i].value,callback:function(e){t.$set(t.customQuestions[i],"value",e)},expression:"customQuestions[i].value"}})]:t._e()],2)})):t._e(),t.invite.allowGuests?[t.contact.hasGuests?e("div",[e("label",{staticClass:"fs-sm text-muted",attrs:{for:"guestsEmail"}},[t._v(t._s(t.$t("guestsEmail")))]),e("BFormTags",{attrs:{"tag-validator":t.isValidEmail,id:"guestsEmail",placeholder:t.$t("addGuestsPlaceholder"),"invalid-tag-text":t.$t("invalidEmails"),"add-button-text":t.$t("add"),"tag-variant":"primary"},model:{value:t.contact.guests,callback:function(e){t.$set(t.contact,"guests",e)},expression:"contact.guests"}})],1):e("span",[e("b-button",{staticClass:"filter_btn active font-weight-500",attrs:{size:"sm"},on:{click:function(e){t.contact.hasGuests=!0}}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:"plus-lg",scale:"0.8"}}),t._v(" "+t._s(t.$t("addGuests"))+" ")],1)],1)]:t._e(),e("div",{staticClass:"d-flex align-items-center justify-content-end mt-auto py-3"},[e("b-button",{staticClass:"filter_btn active mr-3 font-weight-500",attrs:{size:"sm"},on:{click:function(e){t.selectedDate=null}}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:""+(t.$isRtl?"chevron-right":"chevron-left"),scale:"0.8"}}),t._v(" "+t._s(t.$t("back"))+" ")],1),e("b-overlay",{staticClass:"d-inline-block",attrs:{show:t.isLoading,rounded:"",opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},[e("b-button",{staticClass:"filter_btn font-weight-500",attrs:{size:"sm",disabled:t.$v.$invalid||t.isLoading},on:{click:t.schedule}},[t._v(" "+t._s(t.$t("scheduleMeeting"))+" ")])],1)],1)]:[e("span",{staticStyle:{"font-size":"1.5rem"}},[t._v(t._s(t.$t("selectDateAndTime")))]),e("div",{staticClass:"custom_calendar mt-5"},[e("div",{staticClass:"d-flex"},[e("div",{style:""+(t.times.length?"min-width: 70%":"width:100%")},[e("date-picker",{staticClass:"border-0",attrs:{timezone:"UTC","max-date":t.maxDate,"min-date":t.minDate,"disabled-dates":{start:null,end:null},"available-dates":t.availableDates.map((t=>t.date)),"is-expanded":"","title-position":"left",locale:{id:t.$i18n.locale,firstDayOfWeek:2}},on:{"update:from-page":t.updateFromPage},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),e("div",{staticClass:"mt-5"},[e("time-zones",{ref:"timezone",staticClass:"custom_timezone",model:{value:t.timezone,callback:function(e){t.timezone=e},expression:"timezone"}})],1)],1),t.times.length?e("div",{staticClass:"times w-100"},[e("div",{staticClass:"mt-2 pt-1 mb-3 text-nowrap font-weight-500 pl-3"},[t._v(" "+t._s(t.$moment(t.date).format("dddd, MMM D"))+" ")]),e("div",{staticClass:"times_body custom_scroll px-3"},t._l(t.times,(function(s,i){return e("div",{key:i,staticClass:"btn_outline",attrs:{role:"button"},on:{click:function(e){return t.handleSelect(s.value)}}},[t._v(" "+t._s(s.text)+" ")])})),0)]):t._e()])])]],2)])],1)],1)],1)],1)])},a=[],n=s(2416),o=s.n(n),l=s(8557),r=s(9868),c=s(4165),m=s(3673),u=s(6289),d=s(4659),h=s(5795),v=s(2003),f={components:{DatePicker:o(),TimeZones:l.Z,FormInput:r.Z},mixins:[d.oE],data(){return{date:"",month:(0,c.Z)().month(),year:(0,c.Z)().year(),timezone:c.Z.tz.guess(),selectedDate:"",contact:{fullName:"",email:"",guests:[],hasGuests:!1},customQuestions:[],isLoading:!1}},async beforeRouteEnter(t,e,s){v.Z.commit("setAppLoading",!0);try{await v.Z.dispatch("getInviteData",t.params)}catch(i){return s({name:"notFound"})}s()},mounted(){this.customQuestions=this.invite.customQuestions.map((t=>({id:t.id,value:"attachment"==t.type?null:""}))),this.endAppLoading()},validations:{contact:{fullName:{required:h.C1,minLength:(0,h.Ei)(4),maxLength:(0,h.BS)(50)},email:{required:h.C1,email:h.Do}},customQuestions:{$each:{value:{required:(0,h.CF)((function(t){let e=this.getQuestionById(t.id);return e.required}))}}}},computed:{invite(){return this.$store.state.invites.one},inviteImage(){return(0,m.$h)(this.invite.imageInvite)},user(){return this.$store.state.user},userPicture(){return(0,m.$h)(this.user.profile?.picture)},calendarsEvents(){return this.$store.state.calendarsEvents},offset(){return(0,m.os)(this.invite.timezone)-(0,m.os)(this.timezone)},minDate(){return this.invite.dateRange.start.clone().add(this.offset,"m").toDate()},maxDate(){let t=this.invite.dateRange.end;if(t)return t.clone().add(this.offset,"m").toDate()},durationStr(){let t=this.invite.duration;if(t<60)return this.$moment.duration(t,"minutes").humanize();let e=Math.floor(t/60);if(t%=60,0===t)return this.$moment.duration(e,"hours").humanize();e=this.$moment.duration(e,"hours").humanize(),t=this.$moment.duration(t,"minutes").humanize();let s=this.$isRtl?" Ùˆ ":" ";return e+s+t},availableDates(){let t=[],e=this.$moment().utc().startOf("date").month(this.month).year(this.year).startOf("month"),s=e.clone().endOf("month");for(let i of this.invite.availability){let a=(0,u.SA)(i.rrule),n=a.between(e.toDate(),s.toDate());for(let e of n){e=this.$moment(e).utc().add(this.offset,"m");let s=e.clone().startOf("date"),a=e.clone(),n=i.duration,o=t.find((t=>t.date.isSame(s,"date")));o||(o={date:s,intervals:[]},t.push(o));while(n>0){let e=60*a.hour()+a.minute(),i=this.invite.minimumNotice+-1*(0,m.os)(this.timezone);a.clone().isAfter(this.$moment().utc().add(i,"m"))&&(this.isReservedDate(a)||(a.isSame(s,"date")?o.intervals.push({minutes:e}):(s=a.clone(),o=t.find((t=>t.date.isSame(s,"date"))),o?o.intervals.push({minutes:e}):(o={date:s.clone().startOf("date"),intervals:[{minutes:e}]},t.push(o))))),n-=this.invite.slotIncrement,a.add(this.invite.slotIncrement,"m")}}}return t=t.filter((t=>t.intervals.length>0)),t=t.map((t=>(t.intervals.sort(((t,e)=>t.minutes-e.minutes)),t.date=t.date.toDate(),t))),t},availableDate(){return this.availableDates.find((t=>this.$moment(this.date).utc().startOf("date").isSame(this.$moment(t.date).utc().startOf("date"),"date")))},times(){if(!this.availableDate)return[];let{date:t,intervals:e}=this.availableDate;return 0==e.length?[]:(t=this.$moment(t).utc().startOf("date"),e=e.map((e=>{let s=t.clone().minute(e.minutes);return{text:s.clone().format("h:mm a"),value:s.clone().add(-1*this.offset,"m").add((0,m.os)(this.invite.timezone),"m").toDate().toISOString()}})),e)},selectedDateFormat(){let t=this.$moment(this.selectedDate).tz(this.timezone);return t=t.format("ddd, MMM D, h:mm a"),t+" "+this.$moment.tz(this.timezone).format("z")}},watch:{date(){this.selectedDate=""},timezone(){this.date=""}},methods:{isReservedDate(t){let e=-1*(0,m.os)(this.timezone);for(let s of this.calendarsEvents){let i=this.$moment(s.start).utc().add(e,"m"),a=this.$moment(s.end).utc().add(e,"m");if(this.invite.preventConflict){if(t.isSame(i,"minute"))return!0;if(t.isBetween(i,a))return!0}let n=t.clone().add(this.invite.duration,"m"),o=i.clone().add(-1*this.invite.bufferBeforeEvent,"m");if(n.isBetween(i,o)||n.isSame(i,"minute"))return!0;let l=i.clone().add(this.invite.bufferAfterEvent,"m");if(t.isBetween(a,l)||t.isSame(a,"minute"))return!0}return!1},updateFromPage(t){this.month=t.month-1,this.year=t.year},handleSelect(t){this.selectedDate=t},isValidEmail(t){let e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(String(t).toLowerCase())},getQuestionById(t){return this.invite.customQuestions.find((e=>e.id==t))},async schedule(){if(this.$v.$touch(),this.$v.$invalid)return;this.isLoading=!0;let t={inviteID:this.invite.inviteID,fullName:this.contact.fullName,email:this.contact.email,timezone:this.timezone,date:this.selectedDate,customQuestions:this.customQuestions};this.invite.allowGuests&&(t.guests=this.contact.guests);try{let e=await this.$store.dispatch("createEvent",t);this.$store.commit("setEvent",e),this.$router.push({name:"doneEvent",params:{...this.$route.params,isTrusted:!0}})}finally{this.isLoading=!0}}}},p=f,b=s(1001),g=(0,b.Z)(p,i,a,!1,null,null,null),$=g.exports}}]);