"use strict";(self["webpackChunkmawed"]=self["webpackChunkmawed"]||[]).push([[883],{7138:function(t,e,i){i.r(e),i.d(e,{default:function(){return k}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create_one mt-5 position-relative"},[e("b-container",[e("div",{staticClass:"header mt-4 d-flex align-items-center justify-content-between"},[e("div",{staticClass:"h4 mb-0 font-weight-normal"},[t._v(t._s(t.$t("createGroupInvite")))]),e("button",{staticClass:"fs-sm mx-3 filter_btn active",on:{click:t.preview}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:"eye",scale:"1.5"}}),t._v(" "+t._s(t.$t("previewInvite"))+" ")],1)]),e("div",{staticClass:"field_title mt-4 pt-1"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("availableTimes")))])]),e("b-form",{staticClass:"mt-4",on:{submit:function(e){return e.preventDefault(),t.next.apply(null,arguments)}}},[e("b-row",[e("b-col",{staticClass:"mb-4",attrs:{cols:"12",lg:"8"}},[e("form-select",{directives:[{name:"visible",rawName:"v-visible",value:"duration",expression:"'duration'"}],attrs:{label:t.$t("eventDuration"),value:t.invite.duration,options:t.durationOptions,required:""},on:{change:t.durationChanged}},[e("BIcon",{attrs:{slot:"icon_left",icon:"clock-history"},slot:"icon_left"}),t.durationPlaceholder?e("virtual-input",{staticClass:"mb-0",on:{click:function(e){return t.$bvModal.show("DurationModal")}}},[e("span",{staticClass:"text-black",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v(t._s(t.durationPlaceholder))]),e("BIcon",{attrs:{slot:"icon_right",icon:"pencil"},slot:"icon_right"})],1):t._e()],1)],1),e("b-col",{staticClass:"d-none d-lg-block",attrs:{cols:"4"}},[e("div",{staticClass:"d-flex position-absolute fs-sm text-muted",staticStyle:{top:"25px"},attrs:{"data-visible":"duration"}},[e("BIcon",{staticClass:"mt-1",attrs:{icon:"info-circle",scale:"1.5"}}),e("p",{staticClass:"ml-3 mb-0"},[t._v(t._s(t.$t("durationDesc")))])],1)]),e("b-col",{staticClass:"mb-4",attrs:{cols:"12",lg:"8"}},[e("form-select",{directives:[{name:"visible",rawName:"v-visible",value:"slotIncrement",expression:"'slotIncrement'"}],attrs:{label:t.$t("timeSlotIncrement"),options:t.slotIncrementOptions,required:""},model:{value:t.invite.slotIncrement,callback:function(e){t.$set(t.invite,"slotIncrement",e)},expression:"invite.slotIncrement"}},[e("BIcon",{attrs:{slot:"icon_left",icon:"clock"},slot:"icon_left"})],1)],1),e("b-col",{staticClass:"d-none d-lg-block",attrs:{cols:"4"}},[e("div",{staticClass:"d-flex position-absolute fs-sm text-muted",staticStyle:{top:"25px"},attrs:{"data-visible":"slotIncrement"}},[e("BIcon",{staticClass:"mt-1",attrs:{icon:"info-circle",scale:"1.5"}}),e("p",{staticClass:"ml-3 mb-0"},[t._v(" "+t._s(t.$t("slotIncrementDesc"))+" ")])],1)]),e("b-col",{staticClass:"mb-4",attrs:{cols:"12",lg:"8"}},[e("form-select",{directives:[{name:"visible",rawName:"v-visible",value:"dateRange",expression:"'dateRange'"}],attrs:{label:t.$t("dateRange"),value:t.dayRangeValue,options:t.dateRangeOptions,required:""},on:{change:t.dayRangeChanged}},[e("BIcon",{attrs:{slot:"icon_left",icon:"calendar3"},slot:"icon_left"}),t.dateRangeStr?e("virtual-input",{staticClass:"mb-0",attrs:{inputProps:{class:t.dateRangeStr?"d-inline-block w-auto":""}},on:{click:function(e){return t.$bvModal.show("DateRangeModal")}}},[e("span",{staticClass:"text-black",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v(t._s(t.dateRangeStr))]),e("BIcon",{attrs:{slot:"icon_right",icon:"pencil"},slot:"icon_right"})],1):t._e()],1)],1),e("b-col",{staticClass:"d-none d-lg-block",attrs:{cols:"4"}},[e("div",{staticClass:"d-flex position-absolute fs-sm text-muted",staticStyle:{top:"25px"},attrs:{"data-visible":"dateRange"}},[e("BIcon",{staticClass:"mt-1",attrs:{icon:"info-circle",scale:"1.5"}}),e("p",{staticClass:"ml-3 mb-0"},[t._v(" "+t._s(t.$t("dateRangeDesc"))+" ")])],1)]),e("b-col",{attrs:{cols:"12"}},[e("div",{staticClass:"availability mt-4"},[e("div",{staticClass:"availability_header d-flex w-100 align-items-center justify-content-between flex-wrap"},[e("div",{staticClass:"text-muted font-weight-500"},[e("span",[t._v(t._s(t.$t("selectAvailability")))]),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.$t("selectAvailabilityTooltip")}},[e("BIcon",{staticClass:"mx-2",staticStyle:{opacity:"0.5"},attrs:{icon:"question-circle",scale:"1.2"}})],1)]),e("div",{staticClass:"py-2 px-3 rounded-pill font-weight-500 d-flex align-items-center justify-content-center",style:""+(t.invite.preventConflict?"background-color: #f8e71c1c; color: #948a19":"background-color: #ff001a1a; color: #0000008a")},[e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.$t("doubleBookingPreventionToolTip")}},[e("BIcon",{attrs:{icon:"info-circle",scale:"1.2"}})],1),e("span",{staticClass:"fs-sm mx-2"},[t._v(t._s(t.$t("doubleBookingPrevention")))]),e("b-checkbox",{attrs:{switch:""},model:{value:t.invite.preventConflict,callback:function(e){t.$set(t.invite,"preventConflict",e)},expression:"invite.preventConflict"}})],1)]),e("div",{staticClass:"availability_body my-4"},[e("div",{staticClass:"d-flex align-items-center justify-content-between flex-wrap mb-3"},[e("div",{staticClass:"availability_btns_controls d-flex align-items-center justify-content-between fs-sm font-weight-600 flex-wrap",staticStyle:{height:"35px"}},[e("div",{staticClass:"before_btn d-flex align-items-center",class:{disabled:t.isPrevBtnDisabled},on:{click:t.prevDateRange}},[t.$isRtl?e("BIcon",{attrs:{icon:"chevron-right"}}):e("BIcon",{attrs:{icon:"chevron-left"}}),e("span",{staticClass:"mx-1"},[t._v(" "+t._s(t.$t("before"))+" "),e("span",{staticClass:"d-none d-sm-inline-block"},[t._v(t._s(t.FDOL.format("MMM D")))])])],1),e("div",{staticClass:"after_btn d-flex align-items-center ml-4",class:{disabled:t.isNextBtnDisabled},on:{click:t.nextDateRange}},[e("span",{staticClass:"mx-1"},[t._v(" "+t._s(t.$t("after"))+" "),e("span",{staticClass:"d-none d-sm-inline-block"},[t._v(t._s(t.EDOL.format("MMM D")))])]),t.$isRtl?e("BIcon",{attrs:{icon:"chevron-left"}}):e("BIcon",{attrs:{icon:"chevron-right"}})],1),t.isNextBtnDisabled?e("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"extend_btn d-flex align-items-center ml-4",attrs:{title:t.$t("extendTooltip")},on:{click:t.extendDateRange}},[e("BIcon",{attrs:{icon:"plus-lg"}}),e("span",{staticClass:"mx-1"},[t._v(t._s(t.$t("extend"))+" "),e("span",{staticClass:"d-none d-sm-inline-block"},[t._v(t._s(t.$t("dateRange")))])])],1):t._e()]),e("div",{staticClass:"availablity_timezone_control d-flex align-items-center"},[e("time-zones",{model:{value:t.invite.timezone,callback:function(e){t.$set(t.invite,"timezone",e)},expression:"invite.timezone"}}),e("span",{staticClass:"btn_icon ml-2"},[e("NotAllowIcon",{staticStyle:{fill:"#5e5e5e"},attrs:{width:"1.5rem"}})],1)],1)]),e("b-list-group",t._l(t.range,(function(i,a){return e("AvailableItem",{key:a,attrs:{date:i,availableDates:t.availableDates},on:{click:t.openAvailabilityModal}})})),1)],1)])])],1)],1)],1),e("div",{staticClass:"footer_control bg-white border-top w-100"},[e("b-container",{staticClass:"h-100"},[e("div",{staticClass:"d-flex justify-content-end align-items-center h-100"},[e("b-button",{staticClass:"filter_btn active mr-3 font-weight-500",attrs:{size:"sm"},on:{click:t.back}},[e("BIcon",{staticClass:"mr-2",attrs:{icon:""+(t.$isRtl?"chevron-right":"chevron-left"),scale:"0.8"}}),t._v(" "+t._s(t.$t("back"))+" ")],1),e("b-button",{staticClass:"px-3",attrs:{variant:"primary"},on:{click:t.next}},[t._v(" "+t._s(t.$t("next"))+" ")])],1)])],1),e("DurationModal",{model:{value:t.invite.duration,callback:function(e){t.$set(t.invite,"duration",e)},expression:"invite.duration"}}),e("DateRangeModal",{attrs:{value:t.invite.dateRange},on:{submit:t.dateRangeChanged}}),e("AvailabilityModal",{ref:"availabilityModal",attrs:{duration:t.invite.duration},on:{submit:t.availableDateChanged}}),e("PreviewInvite",{ref:"preview"})],1)},n=[],s=(i(6699),i(5294)),l=i(965),o=i(3048),r=i(3375),c=i(8557),d=i(4106),u=i(9511),m=i(1257),h=i(8584),v=i(2088),f=i(325),p=i(9290),b=i(5476),g=i(9033),y=i(6289),D=i(4659),C=i(5795),R=i(2106),w=i(2003),$={components:{FormInput:s.Z,FormTextArea:o.Z,VirtualInput:r.Z,CameraPlus:d.Z,ZoomIcon:u.Z,GoogleMeetIcon:m.Z,URLModal:h.Z,DurationModal:v.Z,DateRangeModal:f.Z,FormSelect:l.Z,AvailabilityModal:p.Z,TimeZones:c.Z,NotAllowIcon:b.Z,AvailableItem:R.Z,PreviewInvite:g.Z},mixins:[D.oE],data(){return{invite:{duration:30,slotIncrement:30,dateRange:{type:"days",start:this.$moment().utc().startOf("date"),end:this.$moment().utc().add(6,"d").startOf("date")},timezone:"",preventConflict:!0,availability:[]},firstDateOfList:this.$moment().utc().startOf("date")}},validations:{invite:{duration:{required:C.C1},slotIncrement:{},dateRange:{},timezone:{},preventConflict:{},availability:{}}},watch:{"invite.dateRange.start"(t){this.firstDateOfList=t},"invite.dateRange":{handler(t,e){let{start:i,end:a,type:n}=t,s=[];for(let l of this.invite.availability){if("indefinite"==n){l.rrule=l.rrule.replace(/(;UNTIL=.+Z)|(UNTIL=.+Z)/g,""),s.push(l);continue}let t=(0,y.SA)(l.rrule);if(-1!=t.toString().indexOf("RDATE")){let e=t.all()[0];if(e=this.$moment(e).utc().startOf("date"),e.isBefore(i,"date")||e.isAfter(a,"date"))continue;s.push(l);continue}let o=/DTSTART:(.+)Z\\/g,r=/UNTIL=(.+)Z/g;l.rrule=l.rrule.replace(o,`DTSTART:${i.locale("en").format("YYYYMMDDTHHmmss")}Z\\`),"indefinite"==e.type?l.rrule=l.rrule+`;UNTIL=${a.locale("en").format("YYYYMMDDTHHmmss")}Z`:l.rrule=l.rrule.replace(r,`UNTIL=${a.locale("en").format("YYYYMMDDTHHmmss")}Z`),s.push(l)}this.invite.availability=s},deep:!0}},async beforeRouteEnter(t,e,i){let a=w.Z.state.invites.one;if(!a.name)return i("/create/group");i((t=>t.init(a)))},computed:{durationOptions(){return this.$store.state.invites.durationOptions},durationPlaceholder(){let t=!this.durationOptions.some((t=>t.value==this.invite.duration));if(!t)return"";let e=this.invite.duration;if(e<60)return this.$moment.duration(e,"minutes").humanize();let i=Math.floor(e/60);if(e%=60,0===e)return this.$moment.duration(i,"hours").humanize();i=this.$moment.duration(i,"hours").humanize(),e=this.$moment.duration(e,"minutes").humanize();let a=this.$isRtl?" و ":" ";return i+a+e},slotIncrementOptions(){return this.$store.state.invites.slotIncrementOptions},dateRangeOptions(){return this.$store.state.invites.dateRangeOptions},dateRangeStr(){let{type:t,start:e,end:i}=this.invite.dateRange;if("indefinite"==t)return this.$t("indefinite");if("days"==t){let t=i.clone().diff(e,"days");return[3,7,31].includes(t)?"":this.$moment.duration(t,"days").humanize()+" "+this.$t("intoFuture")}if("specific"==t){const t=t=>t.year()===this.$moment().year();return e=e.format("MMM D"+(t(e)?"":", YYYY")),i=i.clone().add(-1,"d").format("MMM D"+(t(i)?"":", YYYY")),e===i?e:`${e} - ${i}`}return""},FDOL(){let{start:t}=this.invite.dateRange;return t.isSameOrAfter(this.firstDateOfList)?t.clone():this.firstDateOfList},EDOL(){let{end:t,type:e}=this.invite.dateRange,i=this.firstDateOfList.clone().add(7,"d");return"indefinite"==e||(i=t.isSameOrBefore(i)?t.clone():i),i.clone().add(-1,"d")},until(){return"indefinite"==this.invite.dateRange.type?null:this.invite.dateRange.end.clone()},range(){if(!this.FDOL.isValid()||!this.EDOL.isValid())return[];let t=this.FDOL.clone(),e=this.EDOL.clone(),i=[];while(t.isSameOrBefore(e))i.push(t.clone()),t.add(1,"d");return i},availableDates(){return this.invite.availability.map((t=>{let e=(0,y.SA)(t.rrule);return{duration:t.duration,dates:e.between(this.FDOL.toDate(),this.EDOL.clone().add(1,"d").toDate()),rruleSet:e}}))},dayRangeValue:{get(){let{start:t,end:e,type:i}=this.invite.dateRange;return"indefinite"==i?6:e.clone().diff(t,"days")},set(t){let e=this.$moment().utc().startOf("date"),i=this.$moment().utc().add(t,"d").startOf("date");this.invite.dateRange={type:"days",start:e,end:i}}},isNextBtnDisabled(){let{end:t,type:e}=this.invite.dateRange;if("indefinite"==e)return!1;let i=this.EDOL.clone().add(1,"d");return t.isBetween(this.FDOL,i)||t.isSame(i,"d")},isPrevBtnDisabled(){let{start:t}=this.invite.dateRange;return t.isSame(this.FDOL,"d")}},methods:{init(t){for(let e in t)this.invite[e]=t[e];this.firstDateOfList=this.invite.dateRange.start.clone()},durationChanged(t){if("custom"==t)return this.$bvModal.show("DurationModal");this.invite.duration=t},dayRangeChanged(t){if("custom"==t)return this.$bvModal.show("DateRangeModal");this.dayRangeValue=t},dateRangeChanged(t){this.invite.dateRange=t},nextDateRange(){let{end:t,type:e}=this.invite.dateRange,i=this.firstDateOfList.clone().add(7,"d");"indefinite"!=e&&t.isSameOrBefore(i)&&(i=t.clone()),this.firstDateOfList=i},prevDateRange(){let{start:t}=this.invite.dateRange,e=this.firstDateOfList.clone().subtract(7,"d");this.firstDateOfList=t.isSameOrAfter(e)?t.clone():e},extendDateRange(){this.invite.dateRange.end=this.invite.dateRange.end.clone().add(7,"d")},openAvailabilityModal(t){this.$refs.availabilityModal.show(t)},hourAndMinute(t){let e=Math.floor(t),i=Math.round(60*(t-e));return{hour:e,minute:i}},availableDateChanged(t){let e=[],i=t=>!!e.find((e=>e.duration==t.duration&&e.rrule==t.rrule)),{date:a,intervals:n,repeats:s}=t;if(0==this.invite.availability.length){if("only"==s)for(let t of n){let{start:n,end:s}=t,l=60*(s-n),{hour:o,minute:r}=this.hourAndMinute(n),c="RDATE:"+a.clone().hour(o).minute(r).locale("en").format("YYYYMMDDTHHmmss")+"Z",d={duration:l,rrule:c};i(d)||e.push(d)}else if("all"==s)for(let t of n){let{start:n,end:s}=t,l=60*(s-n),{hour:o,minute:r}=this.hourAndMinute(n),c=new y.pF;c.rrule(new y.Ci({freq:y.Ci.WEEKLY,dtstart:this.invite.dateRange.start.clone().toDate(),until:this.invite.dateRange.end.clone().toDate(),byweekday:[a.clone().weekday()],byhour:[o],byminute:[r]}));let d={duration:l,rrule:c.toString()};i(d)||e.push(d)}else if("weekdays"==s)for(let t of n){let{start:a,end:n}=t,s=60*(n-a),{hour:l,minute:o}=this.hourAndMinute(a),r=new y.pF;r.rrule(new y.Ci({freq:y.Ci.WEEKLY,dtstart:this.invite.dateRange.start.clone().toDate(),until:this.invite.dateRange.end.clone().toDate(),byweekday:[y.Ci.MO,y.Ci.TU,y.Ci.WE,y.Ci.TH,y.Ci.FR],byhour:[l],byminute:[o]}));let c={duration:s,rrule:r.toString()};i(c)||e.push(c)}return void(this.invite.availability=e)}let l=!1;0==n.length&&(l=!0);let o=a.clone().locale("en").format("dd").toUpperCase();for(let r of this.invite.availability){let t,c,{duration:d,rrule:u}=r,m="",h=this.weekdaysFromRRuleString(u),v=-1!=u.indexOf("EXDATE"),f="",p=[];if(0==h.length)m="only";else{m=1==h.length?"all":"weekdays";let e=u.match(/BYHOUR=(\d+);BYMINUTE=(\d+)/);t=+e[1],c=+e[2],f=a.clone().set({hour:t,minute:c}).locale("en").format("YYYYMMDDTHHmmss")+"Z",p=this.exDatesFromRRuleString(u)}if("only"==s){if(!l){for(let t of n){let{start:n,end:s}=t,l=60*(s-n),{hour:o,minute:r}=this.hourAndMinute(n),c="RDATE:"+a.clone().hour(o).minute(r).locale("en").format("YYYYMMDDTHHmmss")+"Z",d={duration:l,rrule:c};i(d)||e.push(d)}l=!0}if("only"==m){let t=this.momentFromRdate(u);t.isSame(a,"d")||i(r)||e.push(r);continue}h.includes(o)&&(v?p.includes(f)||(u+=","+f):u+="\nEXDATE:"+f);let t={duration:d,rrule:u};i(t)||e.push(t)}else if("all"==s){if(!l){for(let t of n){let{start:n,end:s}=t,l=60*(s-n),{hour:o,minute:r}=this.hourAndMinute(n),c=new y.pF;c.rrule(new y.Ci({freq:y.Ci.WEEKLY,dtstart:this.invite.dateRange.start.clone().toDate(),until:this.invite.dateRange.end.clone().toDate(),byweekday:[a.clone().weekday()],byhour:[o],byminute:[r]}));let d={duration:l,rrule:c.toString()};i(d)||e.push(d)}l=!0}if("only"==m)this.momentFromRdate(u).weekday()!=a.weekday()&&(i(r)||e.push(r));else if("all"==m){if(h[0]!=o){if(v&&p.includes(f))if(1==p.length)u=u.replace(/\nEXDATE:.*/,"");else{let t=p.filter((t=>t!=f)).join(",");u=u.replace(/\nEXDATE:.*/,"\nEXDATE:"+t)}let t={duration:d,rrule:u};i(t)||e.push(t)}}else if("weekdays"==m){if(v&&p.includes(f))if(1==p.length)u=u.replace(/\nEXDATE:.*/,"");else{let t=p.filter((t=>t!=f)).join(",");u=u.replace(/\nEXDATE:.*/,"\nEXDATE:"+t)}if(h.includes(o)){let t=new RegExp(`,${o}|${o},`,"g");u=u.replace(t,"")}let t={duration:d,rrule:u};i(t)||e.push(t)}}else if("weekdays"==s){if(!l){for(let t of n){let{start:a,end:n}=t,s=60*(n-a),{hour:l,minute:o}=this.hourAndMinute(a),r=new y.pF;r.rrule(new y.Ci({freq:y.Ci.WEEKLY,dtstart:this.invite.dateRange.start.clone().toDate(),until:this.invite.dateRange.end.clone().toDate(),byweekday:[y.Ci.MO,y.Ci.TU,y.Ci.WE,y.Ci.TH,y.Ci.FR],byhour:[l],byminute:[o]}));let c={duration:s,rrule:r.toString()};i(c)||e.push(c)}l=!0}if("only"==m){let t=this.momentFromRdate(u).locale("en").format("dd");["SA","SU"].includes(t)&&(i(r)||e.push(r))}else"all"==m&&["SA","SU"].includes(h[0])&&(i(r)||e.push(r))}}this.invite.availability=e},weekdaysFromRRuleString(t){if(-1==t.indexOf("BYDAY"))return[];let e=t.match(/BYDAY=([^;]+)/);return e[1].split(",")},momentFromRdate(t){return t=t.split(":")[1],this.$moment(t).utc()},exDatesFromRRuleString(t){if(-1==t.indexOf("EXDATE"))return[];let e=t.split("EXDATE:")[1];return e=e.split(","),e},resetAvailability(){this.invite.availability=[]},preview(){this.$store.commit("setInvite",this.invite),this.$nextTick((()=>this.$refs.preview.open()))},next(){this.$v.$touch(),this.$v.$invalid||(this.$store.commit("setInvite",this.invite),this.$router.push("/create/group/options"))},back(){this.$store.commit("setInvite",this.invite),this.$router.push("/create/group")}}},x=$,_=i(1001),M=(0,_.Z)(x,a,n,!1,null,null,null),k=M.exports}}]);
//# sourceMappingURL=groupWhen.5ab90bb8.js.map